<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="G Khuswana (Khsgud001)">

<title>Book Recommender System Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="khsgud001_assignment_files/libs/clipboard/clipboard.min.js"></script>
<script src="khsgud001_assignment_files/libs/quarto-html/quarto.js"></script>
<script src="khsgud001_assignment_files/libs/quarto-html/popper.min.js"></script>
<script src="khsgud001_assignment_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="khsgud001_assignment_files/libs/quarto-html/anchor.min.js"></script>
<link href="khsgud001_assignment_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="khsgud001_assignment_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="khsgud001_assignment_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="khsgud001_assignment_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="khsgud001_assignment_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#plagarism-declaration" id="toc-plagarism-declaration" class="nav-link active" data-scroll-target="#plagarism-declaration"><span class="header-section-number">1</span> Plagarism Declaration</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">2</span> Introduction</a></li>
  <li><a href="#data-preprocessing" id="toc-data-preprocessing" class="nav-link" data-scroll-target="#data-preprocessing"><span class="header-section-number">3</span> Data Preprocessing</a></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda"><span class="header-section-number">4</span> Exploratory Data Analysis (EDA)</a></li>
  <li><a href="#data-reduction-strategy" id="toc-data-reduction-strategy" class="nav-link" data-scroll-target="#data-reduction-strategy"><span class="header-section-number">5</span> Data Reduction Strategy</a></li>
  <li><a href="#modelling" id="toc-modelling" class="nav-link" data-scroll-target="#modelling"><span class="header-section-number">6</span> Modelling</a>
  <ul class="collapse">
  <li><a href="#item-based-recommendation-system" id="toc-item-based-recommendation-system" class="nav-link" data-scroll-target="#item-based-recommendation-system"><span class="header-section-number">6.1</span> Item-based recommendation system</a></li>
  <li><a href="#user-based-collaborative-recommendation" id="toc-user-based-collaborative-recommendation" class="nav-link" data-scroll-target="#user-based-collaborative-recommendation"><span class="header-section-number">6.2</span> User-based Collaborative Recommendation</a></li>
  </ul></li>
  <li><a href="#matrix-factorization" id="toc-matrix-factorization" class="nav-link" data-scroll-target="#matrix-factorization"><span class="header-section-number">7</span> Matrix factorization</a>
  <ul class="collapse">
  <li><a href="#assess-matrix-factorization" id="toc-assess-matrix-factorization" class="nav-link" data-scroll-target="#assess-matrix-factorization"><span class="header-section-number">7.1</span> Assess Matrix Factorization</a></li>
  </ul></li>
  <li><a href="#model-ensemble" id="toc-model-ensemble" class="nav-link" data-scroll-target="#model-ensemble"><span class="header-section-number">8</span> Model Ensemble</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference"><span class="header-section-number">9</span> Reference</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Book Recommender System Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>G Khuswana (Khsgud001) </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="plagarism-declaration" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Plagarism Declaration</h1>
<p>I, Gudani Khuswana, declare that:</p>
<ol type="1">
<li>This work is my own and has not been copied from any other source.</li>
<li>All references and sources used have been properly cited.</li>
<li>I have not submitted this work elsewhere for credit.</li>
<li>I understand the consequences of academic dishonesty.</li>
</ol>
<p>Signature: ________________________</p>
<p>Date: ____________________________</p>
<div style="page-break-after: always;"></div>
</section>
<section id="introduction" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Introduction</h1>
<p>In a world inundated with choices, personalized recommendations are essential for guiding users toward relevant content. This project aims to develop an ensemble recommender system that suggests books to users based on their past evaluations, utilizing the Book-Crossing dataset, which includes over 278,000 users and more than 271,000 book ratings.</p>
<p>The recommender system will employ collaborative filtering techniques—both user-based and item-based—alongside matrix factorization. This approach will address the cold-start problem for new users, who may initially provide only a few ratings. The project will assess the accuracy of each method individually and then combine them in an ensemble model.</p>
<p>Through exploratory data analysis and thoughtful data reduction, this report seeks to evaluate the effectiveness of these recommendation strategies, ultimately enhancing the user experience in selecting books.</p>
</section>
<section id="data-preprocessing" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data Preprocessing</h1>
<p>The dataset used for this analysis is considered reliable and substantial. It includes data on approximately 271,360 books and nearly 278,000 registered users, who have collectively provided around 1,149,780 ratings. This extensive dataset allows for a robust analysis and enhances the credibility of the findings presented in this report.</p>
<p>To ensure compatibility when constructing matrices with ISBNs and User IDs as row or column names, a transformation is applied to the dataset. Specifically, the prefix “Id” is added to all ISBNs and User IDs. This adjustment is necessary because R automatically adds a prefix of ‘X’ to column or row names that start with a number. By adding “Isbn.” to ISBNs and “User.” to User IDs, this issue is avoided, resulting in cleaner and more manageable data structures.</p>
<p>The data cleaning process for the ‘Year-Of-Publication’ column involved important steps to improve the dataset’s integrity. Initially, invalid entries, such as non-numeric values and outliers like ‘0’ and ‘1376’, were filtered out. Valid year values were converted to integers, and a new datetime column was created to facilitate better handling of dates. The old ‘Year-Of-Publication’ column was dropped, and any remaining invalid years, including ‘2030’ and ‘2050’, were further removed.</p>
</section>
<section id="exploratory-data-analysis-eda" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Exploratory Data Analysis (EDA)</h1>
<p>The bar chart displays the top 6 years of publication based on the number of books published. The years 1998, 1999, 2000, 2001, 2002, and 2003 are shown, with 2002 having the highest count of books published, nearing 10,000. The count for each year is close to 8,000–10,000 publications, indicating a consistent volume of books released across these years.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="khsgud001_assignment_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The Figure below display the distribution of average ratings. On the left, “Average Rating per Book” shows that most books receive an average rating of 0, with fewer books receiving higher average ratings. On the right, “Average Rating per User” shows a similar pattern, where the majority of users have an average rating of 0, but the distribution spreads more evenly across higher rating ranges. This indicates that a significant portion of books and users have low or no ratings, while a smaller group provides higher ratings more consistently.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="khsgud001_assignment_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The bar chart shows the top six books based on their counts, reflecting their popularity. <strong>Selected Poems</strong> stands out as the most prominent, followed by <strong>Little Women</strong> and <strong>Wuthering Heights</strong>, which also have notable but slightly lower counts. The remaining books—<strong>Dracula</strong>, <strong>Adventures of Huckleberry Finn</strong>, <strong>The Secret Garden</strong>, and <strong>The Night Before Christmas</strong>—are still significant, though their counts are lower in comparison.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="khsgud001_assignment_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The Figure below displays the top 10 publishers from the book dataset, with <strong>Harlequin</strong> emerging as the most prolific publisher, having over 6,000 books, followed by <strong>Silhouette</strong> and <strong>Pocket</strong> with more than 3,000 books each. The chart illustrates that these three publishers have a significant dominance over the others, such as <strong>Ballantine Books</strong>, <strong>Bantam Books</strong>, and <strong>Scholastic.</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="khsgud001_assignment_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The bar chart below illustrates the top 10 user locations, with the <strong>USA</strong> having the largest number of users, far exceeding 100,000. <strong>Canada</strong> and the <strong>United Kingdom</strong> follow, each contributing a significant number of users to the dataset. Other countries like <strong>Germany</strong>, <strong>Spain</strong>, and <strong>Australia</strong> also feature prominently, while smaller contributions come from <strong>Italy</strong>, <strong>France</strong>, <strong>Portugal</strong>, and <strong>New Zealand</strong>. This distribution indicates that the user base is predominantly from English-speaking countries, with noticeable participation from several European nations.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="khsgud001_assignment_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To improve the reliability and relevance of the recommendation system, a filtering step was applied to the ratings dataset by removing entries where the <code>Book-Rating</code> was equal to 0. This action ensures that only meaningful ratings, where users actively rated the books, are considered in the analysis. A rating of 0 generally indicates no opinion or lack of feedback, which does not provide valuable information for predicting preferences. By excluding these non-informative ratings, the dataset becomes more focused on explicit user feedback, enhancing the accuracy of both item-based and user-based collaborative filtering models.</p>
<p>The bar chart below shows the distribution of ratings across books, following the exclusion of non-informative ratings (ratings of 0). The distribution indicates that users tend to give higher ratings, with a significant proportion of ratings clustered between 7 and 10. Specifically, the mode of the distribution is at a rating of 8, with over 100,000 cases, followed closely by ratings of 7 and 10. Lower ratings, particularly between 1 and 4, are relatively uncommon. This distribution reflects a positive skew, where users are more likely to rate books favorably, which may suggest a bias toward higher ratings in this dataset.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="khsgud001_assignment_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-reduction-strategy" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Data Reduction Strategy</h1>
<p>In the dataset, users vary significantly in how many books they rate, which impacts the quality and usefulness of the data for building recommender systems. Initially, the number of ratings per user was summarized, showing a wide distribution. The summary statistics reveal that most users have rated a very small number of books, with a median of just one rating per user and an average of approximately 5.57 ratings. Some users, however, are highly active, with the maximum number of ratings reaching 8,524.</p>
<p>This process serves to reduce the noise in the dataset and make it more manageable for both exploratory data analysis and model training. It also mitigates the cold-start problem by focusing on users who have provided enough information to generate reasonable recommendations.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
   1.000    1.000    1.000    5.574    3.000 8524.000 </code></pre>
</div>
</div>
<p>In this project, a pivot table was created from a subset of the top 20,000 user ratings from the dataset. This involved transforming the user-item interaction data, where the <code>User-ID</code> was set as the row identifier and the unique <code>ISBN</code> values were spread across columns representing books. Missing ratings were filled with zeros to ensure all books were represented. The resulting pivot table was then converted into a matrix for further analysis. Upon examining the first 25 rows and columns, it was evident that many users have not rated a majority of the books, resulting in a sparse matrix where the majority of entries are zeros. This sparsity reflects a common challenge in collaborative filtering systems, where users rate only a few items, leading to difficulties in generating accurate recommendations due to insufficient data.</p>
</section>
<section id="modelling" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Modelling</h1>
<p>This project will develop an ensemble recommender system to predict book ratings using three collaborative filtering techniques: User-Based Collaborative Filtering (UBCF), Item-Based Collaborative Filtering (IBCF), and Matrix Factorization (MF). The UBCF approach will identify users with similar rating patterns to generate recommendations, while the IBCF method will focus on the similarities between items to suggest books that are alike to those previously enjoyed by the user. For the Matrix Factorization approach, Singular Value Decomposition (SVD) will be employed to decompose the user-item rating matrix into latent factors that represent user preferences and item characteristics. The accuracy of the matrix factorization model will be assessed through a regularization approach, evaluating the impact of regularization on model performance. Finally, an ensemble model will be created to combine predictions from all three methods, enhancing overall recommendation accuracy. In this section it will besed on both existing users and new users to avoid the cold start problem.</p>
<section id="item-based-recommendation-system" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="item-based-recommendation-system"><span class="header-section-number">6.1</span> Item-based recommendation system</h2>
<p>Item-based Collaborative Filtering (ICF) is commonly used in recommender systems due to its effectiveness in modeling user preferences and its simplicity in providing personalized recommendations <span class="citation" data-cites="xue2019deep">Xue et al. (<a href="#ref-xue2019deep" role="doc-biblioref">2019</a>)</span>. Similar products to those purchased by the user will be identified and recommended based on their resemblance to highly rated items.</p>
<section id="item-based-cf-on-existing-users" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="item-based-cf-on-existing-users"><span class="header-section-number">6.1.1</span> Item-based CF on Existing Users</h3>
<p>The system employs a cosine similarity function to measure the similarity between books while handling missing values by replacing them with zeros. By calculating similarities based on user ratings, the function recommends the top five books similar to a given target book by creating a function to calculate the similarity only on the product id that we choose. For example, when querying the book with ISBN <code>Isbn.0446677450</code>, the system returned several recommendations as show in the table below, all sharing a similarity score of 0.538. This means moderate similarity, indicating that while the recommendations are relevant, more refinement will improve precision.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  ISBN            similarity
  &lt;chr&gt;                &lt;dbl&gt;
1 Isbn.0671621009      0.538
2 Isbn.006092943X      0.538
3 Isbn.0316748641      0.538
4 Isbn.0385235941      0.538
5 Isbn.0696214563      0.538
6 Isbn.0737003219      0.538
7 Isbn.0764504193      0.538
8 Isbn.1583331433      0.538</code></pre>
</div>
</div>
</section>
<section id="item-based-cf-on-new-users" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="item-based-cf-on-new-users"><span class="header-section-number">6.1.2</span> Item-based CF on New Users</h3>
<p>This secton outlines the implementation of an item-based collaborative filtering recommendation system for new users, enabling personalized book suggestions based on user ratings. The results show a list of book recommendations for a new user based on their ratings of previously rated books as shown in the table below. Each entry includes the <strong>ISBN</strong> of a recommended book and its associated <strong>similarity score</strong>, which reflects how closely the book aligns with the user’s preferences based on the provided ratings.</p>
<p>A higher similarity score (in this case, all entries have a score of approximately 0.615 as shown in the table below) indicates that these books are considered closely related to the user’s interests, making them strong candidates for recommendation. The uniformity of the similarity scores suggests that these books share similar characteristics that resonate with the user’s prior ratings</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 17 × 2
   ISBN            similarity
   &lt;chr&gt;                &lt;dbl&gt;
 1 Isbn.0029087104      0.615
 2 Isbn.0030615321      0.615
 3 Isbn.0226726770      0.615
 4 Isbn.0345285549      0.615
 5 Isbn.0345307674      0.615
 6 Isbn.0345331605      0.615
 7 Isbn.0385314744      0.615
 8 Isbn.0394312066      0.615
 9 Isbn.0425050750      0.615
10 Isbn.0451169530      0.615
11 Isbn.0553801031      0.615
12 Isbn.0671461494      0.615
13 Isbn.067163884X      0.615
14 Isbn.0766607119      0.615
15 Isbn.0894803700      0.615
16 Isbn.0939766027      0.615
17 Isbn.1895383129      0.615</code></pre>
</div>
</div>
</section>
</section>
<section id="user-based-collaborative-recommendation" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="user-based-collaborative-recommendation"><span class="header-section-number">6.2</span> User-based Collaborative Recommendation</h2>
<p>Collaborative Filtering relies on three key assumptions: individuals tend to share similar preferences and interests, these preferences remain consistent over time, and future choices can be predicted based on past behavior. The algorithm works by comparing a user’s behavior with that of others to identify similar users, known as “nearest neighbors.” It then predicts the user’s preferences based on the interests or choices of these neighbors <span class="citation" data-cites="zhao2010user">Zhao and Shang (<a href="#ref-zhao2010user" role="doc-biblioref">2010</a>)</span>.</p>
<section id="user-based-cf-for-exisitng-users" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="user-based-cf-for-exisitng-users"><span class="header-section-number">6.2.1</span> User-based CF for Exisitng users</h3>
<p>In this section, a cosine similarity function was defined to calculate the similarity between book ratings by users. Item recommendation function was created, which uses this similarity to identify books related to a specified book based on user ratings. The function was tested using the book “Isbn.0767912098,” yielding a tibble of five recommended books along with their rating counts and average ratings as as shown below. A count of 1 for all recommended books means that each of these books has only been rated by one user in the dataset. The results indicate potential recommendations for users based on existing preferences, showing the effectiveness of this user–based cf.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
# Rowwise: 
  ISBN            count avg_rating
  &lt;chr&gt;           &lt;int&gt;      &lt;dbl&gt;
1 Isbn.006251279X     1         10
2 Isbn.0062732757     1         10
3 Isbn.0141301201     1          5
4 Isbn.0345323211     1          5
5 Isbn.0380006340     1          8</code></pre>
</div>
</div>
</section>
<section id="user-based-cf-for-new-users" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="user-based-cf-for-new-users"><span class="header-section-number">6.2.2</span> User-based CF for New Users</h3>
<p>A recommendation function was created for new users based on their ratings of a few existing books. The new user’s ratings were added to the rating matrix, and their similarity to other users was calculated using cosine similarity. Unrated books were identified, and recommendations were generated based on similarity scores. Each recommended book included the number of ratings and the average rating from other users.</p>
<p>The results showed four recommended books. The first book, “Isbn.0312252617,” had the most ratings (3) and a high average rating of 8.33, indicating it is popular. The last book, “Isbn.0385235941,” had only 1 rating with a lower average of 6, suggesting it is less favored. Overall, these recommendations help the new user find popular and well-liked books to read</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Rowwise: 
  ISBN            count avg_rating
  &lt;chr&gt;           &lt;int&gt;      &lt;dbl&gt;
1 Isbn.0312252617     3       8.33
2 Isbn.0312261594     2       7.5 
3 Isbn.0316748641     1       7   
4 Isbn.0385235941     1       6   </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="matrix-factorization" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Matrix factorization</h1>
<p>Matrix factorization is a powerful approach for reducing data dimensions, uncovering hidden features, and addressing sparsity issues. It is commonly applied in recommender systems due to these strengths. One popular matrix factorization technique used in recommenders is Singular Value Decomposition (SVD) <span class="citation" data-cites="mehta2017review">Mehta and Rana (<a href="#ref-mehta2017review" role="doc-biblioref">2017</a>)</span>.</p>
<p>The recommendation system utilizes the <strong>Recosystem</strong> package, employing matrix factorization to predict book ratings for both existing and new users. The dataset underwent preparation, including filtering user ratings to a maximum of 50, an 80/20 train-test split, and converting ISBNs to numeric factors. The model was trained with 20 latent dimensions and a learning rate of 0.1, resulting in a significant reduction in RMSE from 5.9392 to 0.2966 over 20 iterations, indicating effective learning. Predictions were made on the test data to estimate user ratings, while a strategy to address the cold-start problem was implemented by allowing new users to provide up to five explicit ratings.</p>
<p>The table compares the actual user ratings with the predicted ratings, allowing for the evaluation of the model’s accuracy in predicting book ratings. Higher alignment between actual ratings (<code>Book-Rating</code>) and predicted ratings (<code>Predicted-Rating</code>) indicates better model performance. <strong>User-ID</strong>: 276747 rated a book with ISBN <strong>1891</strong> with a <strong>rating of 6</strong>, and the model predicted a <strong>rating of 7.10</strong>. This suggests that the model has reasonably approximated the user’s preference. This analysis will be further extended by calculating RMSE to quantify the accuracy of the model.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>iter      tr_rmse          obj
   0       5.9392   6.5445e+06
   1       3.3213   2.0467e+06
   2       1.9689   7.1922e+05
   3       1.4105   3.6912e+05
   4       1.1571   2.4841e+05
   5       1.0214   1.9357e+05
   6       0.9248   1.5868e+05
   7       0.8425   1.3168e+05
   8       0.7673   1.0924e+05
   9       0.6975   9.0273e+04
  10       0.6337   7.4510e+04
  11       0.5764   6.1643e+04
  12       0.5252   5.1180e+04
  13       0.4796   4.2684e+04
  14       0.4391   3.5776e+04
  15       0.4031   3.0145e+04
  16       0.3718   2.5641e+04
  17       0.3436   2.1908e+04
  18       0.3187   1.8845e+04
  19       0.2966   1.6319e+04</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  User-ID  ISBN Book-Rating Predicted-Rating
1  276747 18916           9         7.100761
2  276747 27255           7         8.556341
3  276813 30289           8         7.774769
4  276822  4000           9         3.777657
5  276822  4093          10         8.885351
6  276822 22937          10         5.792573</code></pre>
</div>
</div>
<section id="assess-matrix-factorization" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="assess-matrix-factorization"><span class="header-section-number">7.1</span> Assess Matrix Factorization</h2>
<p>In this section, the accuracy of the matrix factorization recommender system was evaluated with and without regularization. The models were trained using the same dataset, with the regularization parameters set to zero for the first model and to 0.1 for the second. The training process showed a decrease in training RMSE for both models, indicating effective learning. The RMSE on the test set showed that the model with regularization achieved a lower error rate of 2.317 compared to 2.368 for the model without regularization. This suggests that incorporating regularization improved the model’s ability to generalize to unseen data, reducing overfitting and improving its predictive accuracy for book ratings.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>RMSE without regularization: 2.366356 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE with regularization: 2.318515 </code></pre>
</div>
</div>
</section>
</section>
<section id="model-ensemble" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Model Ensemble</h1>
<p>In this section, the process involves combining predictions from three recommendation methods—item-based collaborative filtering, user-based collaborative filtering, and matrix factorization—into a single data frame (<code>ensemble_predictions</code>) using ISBN as a common identifier. By calculating the average predicted ratings for each book, the ensemble approach leverages the strengths of individual models, improving prediction accuracy and reducing bias and variance. The ensemble predictions are then compared to actual ratings from the test data, which is important for assessing performance. Root Mean Squared Error and Mean Absolute Error are computed to quantify the accuracy of the ensemble predictions, providing a comprehensive evaluation of the model’s performance.</p>
<p>The accuracy metrics obtained included a Root Mean Squared Error (RMSE) of 2.6535 and a Mean Absolute Error (MAE) of 2.1310. The RMSE value was higher compared to the matrix factorization model with regularization, which achieved an RMSE of 2.32. This indicates a moderate level of prediction error, suggesting that while the ensemble model captures some trends in the data, there remains a significant discrepancy between the predicted and actual ratings. The performance of the combined model is not as effective as that of the matrix factorization approach with regularization.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Root Mean Squared Error (RMSE) for Ensemble Predictions: 2.653546 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Absolute Error (MAE) for Ensemble Predictions: 2.13104 </code></pre>
</div>
</div>
</section>
<section id="reference" class="level1 unnumbered" data-number="9">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">9 Reference</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-mehta2017review" class="csl-entry" role="listitem">
Mehta, Rachana, and Keyur Rana. 2017. <span>“A Review on Matrix Factorization Techniques in Recommender Systems.”</span> In <em>2017 2nd International Conference on Communication Systems, Computing and IT Applications (CSCITA)</em>, 269–74. IEEE.
</div>
<div id="ref-xue2019deep" class="csl-entry" role="listitem">
Xue, Feng, Xiangnan He, Xiang Wang, Jiandong Xu, Kai Liu, and Richang Hong. 2019. <span>“Deep Item-Based Collaborative Filtering for Top-n Recommendation.”</span> <em>ACM Transactions on Information Systems (TOIS)</em> 37 (3): 1–25.
</div>
<div id="ref-zhao2010user" class="csl-entry" role="listitem">
Zhao, Zhi-Dan, and Ming-Sheng Shang. 2010. <span>“User-Based Collaborative-Filtering Recommendation Algorithms on Hadoop.”</span> In <em>2010 Third International Conference on Knowledge Discovery and Data Mining</em>, 478–81. IEEE.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>